{% extends "base.html" %} {%block title %}Pythagoras' Theorem{% endblock %}
{% block content %}
<!--The visualisation resource-->
<div style="width: min-content; margin: auto;">
<h1>Pythagoras' Theorem</h1>
<hr>
</div>

<!-- Content-->
<div class="part">
    <p class="text">
        For a right-angled triangle, the side that is opposite to the right angle is always 
        the longest. We call this side the <b>hypotenuse</b>.
    </p>
    <svg id="svg1" class="svg-diagram" style="height: 30vw;"></svg> <!-- Visual diagram -->
    <!-- Continue button to the next part -->
    <div class="continue-container">
        <button type="button" class="button1" style="overflow: hidden;" onclick="continuePart(this)">Continue</button>
    </div>
</div>

<div class="part" id="slot1">
    <p class="text">
        So for instance, the <b>hypotenuse</b> for the triangle below would be...
    </p>
    <svg id="svg2" class="svg-diagram" style="height: 30vw;"></svg> <!-- Visual diagram -->
    <div id="question1" class="choices-container"></div> <!-- Answering container -->
    <!-- Continue button to the next part -->
    <div class="continue-container">
        <button type="button" class="button1" style="overflow: hidden;" onclick="continuePart(this)">Continue</button>
    </div>
</div>

<div class="part" id="explain1">
    <p class="text"><b>[mark] Answer : </b></p>
    <p class="text"><b>Explanation: </b></p>
    <!-- Continue button to the next part -->
    <div class="continue-container">
        <button type="button" class="button1" style="overflow: hidden;" onclick="continuePart(this)">Continue</button>
    </div>
</div>

<div class="part">
    <p class="text">
        Now let's give each side of the triangle a variable name, specifically, let's call the hypotenuse 
        $c$, and the other two sides as $a$ & $b$ respectively.
    </p>
    <svg id="svg4" class="svg-diagram" style="height: 30vw;"></svg> <!-- Visual diagram -->
    <div class="continue-container">
        <button type="button" class="button1" style="overflow: hidden;" onclick="continuePart(this)">Continue</button>
    </div>
</div>

<div class="part">
    <p class="text">
        If we then make $3$ squares on each side of the triangle, we get $3$ differently sized squares, 
        with <b>side lengths</b> $a, b,$ & $c$.
    </p>
    <svg id="svg5" class="svg-diagram" style="height: 30vw;"></svg> <!-- Visual diagram -->
    <div class="continue-container">
        <button type="button" class="button1" style="overflow: hidden;" onclick="continuePart(this)">Continue</button>
    </div>
</div>

<div class="part">
    <p class="text">
        Pythagoras' theorem states that for a right-angled triangle with sides $a, b,$ & $c$ like so, 
        the <b>area of the square</b> on $c$ is <b>equal</b> to the <b>area of the square</b> on $a$ & $b$ <b>summed</b> together.
    </p>
    <svg id="svg6" class="svg-diagram" style="height: 30vw;"></svg> <!-- Visual diagram -->
    <div class="continue-container">
        <button type="button" class="button1" style="overflow: hidden;" onclick="continuePart(this)">Continue</button>
    </div>
</div>

<div class="part" id="slot2">
    <p class="text">
        We can calculate the area of a square by doing <b>side length$\times$side length</b>, which means for the square below, the area would be...
    </p>
    <svg id="svg7" class="svg-diagram" style="height: 30vw;"></svg> <!-- Visual diagram -->
    <div id="question2" class="choices-container"></div> <!-- Answering container -->
    <!-- Continue button to the next part -->
    <div class="continue-container">
        <button type="button" class="button1" style="overflow: hidden;" onclick="continuePart(this)">Continue</button>
    </div>
</div>

<div class="part" id="explain2">
    <p class="text"><b>[mark] Answer : </b></p>
    <p class="text"><b>Explanation: </b></p>
    <!-- Continue button to the next part -->
    <div class="continue-container">
        <button type="button" class="button1" style="overflow: hidden;" onclick="continuePart(this)">Continue</button>
    </div>
</div>

<div class="part">
    <p class="text">That means, we can also express Pythagoras's theorem as:</p>
    <p class="text"><i>"The <b>square of the hypotenuse</b> is equal to the <b>sum</b> of the <b>squares of the other two sides</b>"</i></p>
    <p class="text">Or algebraically as: $$a^2+b^2=c^2$$</p>
    <svg id="svg9" class="svg-diagram" style="height: 30vw;"></svg> <!-- Visual diagram -->
    <div class="continue-container">
        <button type="button" class="button1" style="overflow: hidden;" onclick="continuePart(this)">Continue</button>
    </div>
</div>

<div class="part">
    <p class="text">But how is this theorem useful?</p>
    <p class="text">
        It means that for <b>any right-angled triangle</b>, when the length of $2$ sides are given, 
        we can <b>always work out the last side's length</b> using the theorem.
    </p>
    <div class="continue-container">
        <button type="button" class="button1" style="overflow: hidden;" onclick="continuePart(this)">Continue</button>
    </div>
</div>

<div class="part">
    <p class="text">For example, here is a right-angled triangle with $2$ sides given:</p>
    <svg id="svg11" class="svg-diagram" style="height: 30vw;"></svg> <!-- Visual diagram -->
    <p class="text">
        We can work out the length $x$ by using the theorem:
        $$x^2+12^2=13^2$$
        And simply solve for $x$ afterwards:
        $$x^2=13^2-12^2$$
        $$x^2=169-144$$
        $$x^2=25$$
        $$x=\sqrt{25}$$
        $$x=5$$
    </p>
    <div class="continue-container">
        <button type="button" class="button1" style="overflow: hidden;" onclick="continuePart(this)">Continue</button>
    </div>
</div>

<div class="part">
    <p class="text">We can also use the <b>Converse </b>of Pythagoras' theorem to <b>determine</b> whether a triangle
        <b>is a right-angled triangle </b>when <b>given all sides,</b> like this triangle for instance:<p>
    <svg id="svg12" class="svg-diagram" style="height: 30vw;"></svg> <!-- Visual diagram -->
    <p class="text">
        We can take the sum of the squares on $2$ of the shorter sides:
        $$8^2+15^2=289$$
        And then take the square on the longest side:
        $$17^2=289$$
        Now because the results are equal, we can conclude that this triangle is in fact a <b>right-angled triangle.</b>
    </p>
    <div class="continue-container">
        <button type="button" class="button1" style="overflow: hidden;" onclick="continuePart(this)">Continue</button>
    </div>
</div>

<div class="part" id="slot3">
    <p class="text">Here is another one, using the converse of Pythagoras' theorem, we can say that this triangle is...</p>
    <svg id="svg13" class="svg-diagram" style="height: 30vw;"></svg> <!-- Visual diagram -->
    <div id="question3" class="choices-container"></div> <!-- Answering container -->
    <div class="continue-container">
        <button type="button" class="button1" style="overflow: hidden;" onclick="continuePart(this)">Continue</button>
    </div>
</div>

<div class="part" id="explain3">
    <p class="text"><b>[mark] Answer : </b></p>
    <p class="text"><b>Explanation: </b></p>
    <!-- Continue button to the next part -->
    <div class="continue-container">
        <button type="button" class="button1" style="overflow: hidden;" onclick="continuePart(this)">Continue</button>
    </div>
</div>

<div class="part">
    <p class="text">In mathematics, a <b>theorem </b>is a <b>statement </b> that has been <b>proven</b>, 
    so what are some proofs for the Pythagoras' theorem?</p>
    <p class="text">
        There are actually various proofs for this theorem that were discovered by many mathematician 
        throughout history, here is one of the most well-known one called the <b>rearrangement proof</b>:
    </p>
    <div class="continue-container">
        <button type="button" class="button1" style="overflow: hidden;" onclick="continuePart(this)">Continue</button>
    </div>
</div>



<script>
    // Disable continue buttons that are in questions part
    let continues = document.getElementsByClassName("continue-container")
    for (let i=0;i<continues.length;i++) {
        if (continues[i].parentElement.id.includes("slot")) {
            continues[i].firstElementChild.disabled = true
        }
    }

    // Function for continue button to disprlay the next part
    continuePart = async (button) => {
        button.style.opacity = 0
        button.style.transform = "translateY(-10px)"
        button.parentElement.style.height = 0
        // If part is question
        if (button.parentElement.parentElement.id.includes("slot")) {
            let choices = button.parentElement.parentElement.getElementsByClassName("choices-container")
            let submit
            for (let i=0;i<choices[0].children.length;i++) {
                choices[0].children[i].disabled = true
                if (choices[0].children[i].classList.contains("active")) {
                    submit = choices[0].children[i]
                }
            }
            // Next part with explanation
            let explain = document.getElementById("explain"+button.parentElement.parentElement.id.slice(-1))
            let answer = explain.querySelector(".text")
            // Verify answer
            let correct = false
            let mjxMath = answer.querySelectorAll('[data-mml-node="math"]')
            if (mjxMath.length != 0) {
                for (i=0;i<mjxMath.length;i++) {
                    if (mjxMath[i].getAttribute("data-latex") == submit.querySelector('[data-mml-node="math"]').getAttribute("data-latex")) {
                        correct = true
                        break
                    }
                }
            } else if (submit.innerHTML == answer.innerHTML.split('<b>[mark] Answer : </b>')[1]) {
                correct = true
            }
            if (correct == true) {
                // Correct answer
                explain.style.backgroundColor = "var(--pc3)"
                answer.innerHTML = answer.innerHTML.replace("[mark]","&#x2714;")
            } else {
                // Wrong answer
                explain.style.backgroundColor = "var(--pink)"
                answer.innerHTML = answer.innerHTML.replace("[mark]","&#x2718;")
            }
        }
        // Show next part
        let nextPart = button.parentElement.parentElement.nextElementSibling
        nextPart.style.height = nextPart.scrollHeight+"px"
        nextPart.style.opacity = 1
        await delay(300)
        button.parentElement.remove()
    }

    function answerField(pick, questionDiv) {
        let choices = pick[3].split('|')
        for (let i=0;i<choices.length;i++) {
            let button = document.createElement("button")
            button.classList += "button1"
            button.addEventListener('mousedown', function() {
                let buttons = button.parentElement.children
                for (let i=0;i<buttons.length;i++) {
                    buttons[i].classList.remove("active")
                }
                button.classList.toggle("active")
                button.parentElement.parentElement.getElementsByClassName("continue-container")[0].children[0].disabled = false
            })
            button.innerHTML = choices[i]
            questionDiv.appendChild(button)
        }
    }

    function explainField(pick, explainDiv) { 
        explainDiv[0].innerHTML += (pick[2]).replace('|', " or ")
        explainDiv[1].innerHTML += pick[4]
    }
</script>


<!-- Script for diagramatics -->
<script type="module">
    import * as dg from 'https://cdn.jsdelivr.net/npm/diagramatics@1.5/dist/diagramatics.min.js'
    import * as questions from '{{questionsPath}}'
    let color = (colorVar) => window.getComputedStyle(document.documentElement).getPropertyValue('--'+colorVar)
    let draw_tex = (svg, ...diagrams) => {dg.draw_to_svg_element(svg, dg.diagram_combine(...diagrams))}
    let draw = (svg, ...diagrams) => {
        dg.draw_to_svg(svg, dg.diagram_combine(...diagrams))
        dg.handle_tex_in_svg(svg, handletex)
    }
    let bounding = (x,y) => dg.rectangle(x,y).strokewidth(0)
    let handletex = (str, conf) => {
        return MathJax.tex2svg(str, conf).innerHTML;
    }
    function pickQuestion (slotId) {
        let questionsQeury = {{questions|tojson}}
        let slot = []
        for (let i=0;i<questionsQeury.length;i++) {
            if (questionsQeury[i][5] == slotId) {
                slot.push(questionsQeury[i])
            }
        }
        return slot[Math.floor(Math.random() * slot.length)]
    }
    
    // Part 1
    let svg1 = document.getElementById("svg1")
    let tri1 = dg.polygon([dg.V2(-1.5,-1), dg.V2(-1.5,1), dg.V2(1.5,-1)]).stroke(color("hl4"))
    let ang1 = dg.square(0.3).position(dg.V2(-1.35,-0.85)).stroke(color("hl3"))
    let ann1 = dg.annotation.length(dg.V2(-1.5,1), dg.V2(1.5,-1), 'Hypotenuse', -0.15, 0.1, -0.5).stroke(color("pc1")).fontsize(20)
    draw(svg1, bounding(3,3), tri1, ang1, ann1)
    
    // Part 2
    var pick = pickQuestion(1)
    let svg2 = document.getElementById("svg2")
    let question1 = document.getElementById("question1")
    answerField(pick, question1)
    draw(svg2, ...eval(`questions.${pick[1]}()`))
    
    // Part 3
    // Insert eplanation & answer into text paragraph to verify
    explainField(pick, document.getElementById("explain1").querySelectorAll(".text"))
    
    // Part 4
    let svg4 = document.getElementById("svg4")
    let ang4 = dg.square(0.3).position(dg.V2(-0.85,-0.6)).stroke(color("hl3"))
    let tri4 = dg.polygon([dg.V2(-1,-0.75), dg.V2(-1,0.75), dg.V2(1,-0.75)]).stroke(color("hl4")).combine(ang4)
    let [a4,b4,c4] = [dg.textvar("a").position(dg.V2(-1.3,0)), dg.textvar("b").position(dg.V2(0,-1)), dg.textvar("c").position(dg.V2(0.1,0.2))]
    draw(svg4, bounding(2.5,2.5), tri4, a4.fontsize(24),b4.fontsize(24),c4.fontsize(24))
    
    // Part 5
    let sqStyle = (d) => d.strokedasharray([10]).stroke(color("hl3"))
    let svg5 = document.getElementById("svg5")
    let [Asq5,Bsq5,Csq5] = [
        dg.square(1.5).position(dg.V2(-1.75,0)).apply(sqStyle),
        dg.square(2).position(dg.V2(0,-1.75)).apply(sqStyle),
        dg.square(2.5).rotate(-Math.atan(0.75)).position(dg.V2(0.75, 1)).apply(sqStyle)
    ]
    draw(svg5, tri4, a4.fontsize(24),b4.fontsize(24),c4.fontsize(24),Asq5, Bsq5, Csq5)

    // Part 6
    let svg6 = document.getElementById("svg6")
    let sq6 = [dg.square(1.5).apply(sqStyle),dg.square(2).apply(sqStyle),dg.square(2.5).apply(sqStyle)]
    sq6 = dg.distribute_horizontal(sq6, 1)
    let [a6,b6,c6] = [
        dg.annotation.length(dg.V2(-0.75,-0.75), dg.V2(0.75,-0.75), 'a', 0.3, 0.2).stroke(color("pc1")).fontsize(24),
        dg.annotation.length(dg.V2(1.75,-1), dg.V2(3.75,-1), 'b', 0.3, 0.2).stroke(color("pc1")).fontsize(24),
        dg.annotation.length(dg.V2(4.75,-1.25), dg.V2(7.25,-1.25), 'c', 0.3, 0.2).stroke(color("pc1")).fontsize(24)
    ]
    let text6 = [
        dg.textvar('+').position(dg.V2(1.25,0)).fontsize(24),
        dg.textvar('=').position(dg.V2(4.25,0)).fontsize(24)
    ]
    draw(svg6, sq6, a6, b6, c6, text6[0], text6[1]  )

    // Part 7
    var pick = pickQuestion(2)
    let svg7 = document.getElementById("svg7")
    let question2 = document.getElementById("question2")
    answerField(pick, question2)
    draw(svg7, ...eval(`questions.${pick[1]}()`))
    
    // Part 8
    // Insert eplanation & answer into text paragraph to verify
    explainField(pick, document.getElementById("explain2").querySelectorAll(".text"))
    
    // Part 9
    let svg9 = document.getElementById("svg9")
    draw(svg9, sq6, text6[0], text6[1], dg.textvar('$a^2$').position(dg.V2(0,0)).fontsize(24),
        dg.textvar('$b^2$').position(dg.V2(2.75,0)).fontsize(24), dg.textvar('$c^2$').position(dg.V2(6,0)).fontsize(24))

    // Part 11
    let tri11 = dg.polygon([dg.V2(0,0), dg.V2(0,1), dg.V2(2.4,0)]).stroke(color("hl4")).combine(dg.square(0.2).position(dg.V2(0.1,0.1)).stroke(color("hl4"))).position(dg.V2(-1.2, -0.5))
    let [a11,b11,c11] = [dg.textvar("x").position(dg.V2(-1.4,0)), dg.textvar("12").position(dg.V2(0,-0.7)), dg.textvar("13").position(dg.V2(0,0.2))]
    draw(svg11, bounding(2.5,2.5), tri11, a11.fontsize(24),b11.fontsize(24),c11.fontsize(24))

    // Part 12
    let tri12 = dg.polygon([dg.V2(0,0), dg.V2(0,1.875), dg.V2(1,0)]).stroke(color("hl4")).position(dg.V2(0.5, -0.5)).rotate(1)
    let [a12,b12,c12] = [dg.textvar("8").position(dg.V2(0.9,-0.2)), dg.textvar("15").position(dg.V2(-0.3,-0.3)), dg.textvar("17").position(dg.V2(0.1,0.6))]
    draw(svg12, bounding(2.5,2.5), tri12, a12.fontsize(24),b12.fontsize(24),c12.fontsize(24))
    
    // Part 13
    var pick = pickQuestion(3)
    let svg13 = document.getElementById("svg13")
    let question3 = document.getElementById("question3")
    answerField(pick, question3)
    draw(svg13, ...eval(`questions.${pick[1]}()`))
    
    // Part 14
    // Insert eplanation & answer into text paragraph to verify
    explainField(pick, document.getElementById("explain3").querySelectorAll(".text"))
    

    
    try{MathJax.typeset()} catch{}
</script>
{% endblock %}
